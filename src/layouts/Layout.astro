---
import Footer from "@components/general/Footer.astro";
import Navbar from "@components/general/Navbar.astro";
import "../styles/style.css";
---

<!-- Critical script: Must run BEFORE HTML parsing completes to prevent CLS -->
<script is:inline>
  // Immediately set theme without triggering reflow
  (function() {
    var t = 'light';
    try {
      t = localStorage.getItem('theme') || 
        (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    } catch (e) {}
    document.documentElement.setAttribute('data-theme', t);
    document.documentElement.setAttribute('lang', 'en');
  })();
</script>

<!-- Critical CSS for above-the-fold content - Inlined to eliminate render-blocking -->
<style>
  /* Base styles */
  html{font-size:16px}
  body{font-size:16px;line-height:1.6;margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif}
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
  
  /* Theme colors - Critical for LCP */
  [data-theme="light"]{--bg-light:#FFFFFF;--bg-dark:#111111;--text-dark:#1f2937;--text-light:#f3f4f6}
  [data-theme="dark"]{--bg-light:#111111;--bg-dark:#FFFFFF;--text-dark:#f3f4f6;--text-light:#1f2937}
  body{background-color:var(--bg-light);color:var(--text-dark)}
  
  /* Typography - Above the fold */
  h1,h2,h3,h4,h5,h6{font-weight:600;line-height:1.2}
  h1{font-size:clamp(3rem,8vw,6rem);font-weight:700}
  h2{font-size:1.25rem}
  
  /* Container - Critical for layout */
  .container{max-width:1112px;margin:0 auto;padding:0 1rem}
  
  /* Skip link */
  .skip-link{position:absolute;top:-100px;left:0;z-index:9999}
</style>

<!-- Skip to main content link for accessibility -->
<a href="#main-content" class="skip-link" tabindex="0">Skip to main content</a>

<Navbar />
<main id="main-content" class="container">
  <slot />
</main>
<Footer />

<style>
  .skip-link {
    position: absolute;
    top: -100px;
    left: 0;
    background: #2563eb;
    color: white;
    padding: 12px 16px;
    text-decoration: none;
    z-index: 9999;
    border-radius: 0 0 8px 0;
    font-weight: 600;
    transition: top 0.2s ease;
  }
  
  .skip-link:focus {
    top: 0;
    outline: 3px solid #fff;
    outline-offset: 2px;
  }
</style>
